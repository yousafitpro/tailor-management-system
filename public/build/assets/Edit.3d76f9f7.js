import{L as H}from"./Layout.552d4a0a.js";import{g as $}from"./debounce.59045531.js";import{T as K}from"./TextInput.a9140c34.js";import{d as P}from"./DeleteMixin.0ad892e7.js";import{R as Q}from"./RadioInput.0846cb2e.js";import{S as W}from"./SelectInput.91e4d7fc.js";import{C as X}from"./CheckboxInput.b20b031f.js";import{T as Y}from"./TextareaInput.2286e672.js";import{L as Z}from"./LoadingButton.b23816ca.js";import{T as ee}from"./TrashedMessage.c9dc924a.js";import{D as re}from"./DeleteRestoreComponent.a3bd8ca8.js";import{_ as se,r as c,o,c as m,a as n,b as d,e as v,h as g,t as u,f as y,d as f,w as te,n as D,F as b,j as k}from"./app.beedf8fa.js";import"./Dropdown.9c297445.js";import"./FlashMessages.01bf9828.js";import"./InputError.a8df13b4.js";import"./Dialog.a0ead295.js";import"./Modal.5ea56083.js";const le={layout:H,remember:"form",mixins:[P("measurement")],props:{measurement:Object,iservices:Array},components:{CheckboxInput:X,LoadingButton:Z,RadioInput:Q,SelectInput:W,TextInput:K,TextareaInput:Y,TrashedMessage:ee,DeleteRestoreComponent:re},metaInfo(){return{title:this.$t("edit_x",{x:this.form.name})}},data(){return{restore:!1,sending:!1,form:{name:this.measurement.name,service_id:this.measurement.service.id,customer_id:this.measurement.customer.id,measurement:this.measurement.measurement},service:{value:this.measurement.service.id,label:this.measurement.service.name,measurement_fields:this.measurement.service.measurement_fields},customer:{label:this.measurement.customer.name,value:this.measurement.customer.id},services:[],customers:[]}},watch:{customer:function(e,s){this.form.customer_id=e?e.value:null,(!this.form.name||this.service&&this.form.name==this.service.label||this.form.name==(s?s.label+"'s ":"")+(this.service?this.service.label:""))&&(this.form.name=(e?e.label:"")+(this.service?"'s "+this.service.label:""))},service:function(e,s){this.form.service_id=e?e.value:null,(!this.form.name||this.customer&&this.form.name==this.customer.label||this.form.name==(this.customer?this.customer.label+"'s ":"")+(s?s.label:""))&&(this.form.name=(this.customer?this.customer.label+"'s ":"")+(e?e.label:"")),s&&s.measurement_fields.map(l=>{delete this.form[l.name]}),e&&e.measurement_fields.map(l=>{l.type=="Checkbox"?(this.form[l.name]={},l.options.map(p=>this.form[l.name][p.value]=!1)):this.form[l.name]=null})}},created(){this.service.measurement_fields.map((e,s)=>{if(this.measurement.extra_attributes&&this.measurement.extra_attributes.length){let l=this.measurement.extra_attributes.find(p=>Object.keys(p)[0]==e.name);e.type=="Checkbox"?l?this.form[e.name]=JSON.parse(l[e.name]):(this.form[e.name]={},e.options.map(p=>this.form[e.name][p.value]=!1)):this.form[e.name]=l?l[e.name]+"":""}else e.type=="Checkbox"?(this.form[e.name]={},e.options.map(l=>this.form[e.name][l.value]=!1)):this.form[e.name]=null})},mounted(){this.customers=[this.customer],this.services=[...this.iservices,this.service]},methods:{submit(){this.sending=!0;let e={...this.form};if(this.service.measurement_fields&&this.service.measurement_fields.length>0){let s=[];this.service.measurement_fields.map((l,p)=>{delete e[l.name];let t={};t[l.name]=l.type=="Checkbox"?JSON.stringify(this.form[l.name]):this.form[l.name],s[p]={...t}}),e.extra_attributes=[...s]}this.$inertia.put(this.route("measurements.update",this.measurement.id),e,{onFinish:()=>this.sending=!1})},updateFormValue(e,s,l){l?this.form[s][l]=!!e:this.form[s]=e&&e.target&&e.target.value?e.target.value:e},searchCustomers(e,s){e&&(s(!0),this.searchingCustomers(s,e,this))},searchingCustomers:$((e,s,l)=>{fetch(l.route("ajax.customers")+"?search="+s).then(p=>{p.json().then(t=>l.customers=t),e(!1)})},350),searchServices(e,s){e&&(s(!0),this.searchingServices(s,e,this))},searchingServices:$((e,s,l)=>{fetch(l.route("ajax.services")+"?with_fields=1&search="+s).then(p=>{p.json().then(t=>l.services=t),e(!1)})},350)}},oe={class:"mb-6 mt-2 font-bold text-lg md:text-2xl"},me=n("span",{class:"text-gray-400 font-medium mx-2"},"/",-1),ae={class:"bg-white rounded shadow overflow-hidden max-w-3xl"},ne={class:"p-8 ltr:-mr-6 rtl:-ml-6 ltr:ml-0 rtl:mr-0 -mb-8 flex flex-wrap"},ie={class:"px-8 pb-8 ltr:-mr-6 rtl:-ml-6 ltr:ml-0 rtl:mr-0 -mb-8 flex flex-wrap"},ue={class:"ltr:pr-6 rtl:pl-6 pb-8 w-full lg:w-1/2"},pe={class:"form-label",for:"customer_id"},ce={key:0,class:"form-error"},de={class:"ltr:pr-6 rtl:pl-6 pb-8 w-full lg:w-1/2"},he={class:"form-label",for:"service_id"},fe={key:0,class:"form-error"},_e={key:0,class:"ltr:pr-6 rtl:pl-6 ltr:-mr-12 rtl:-ml-12 w-full"},be={class:"font-bold mb-2"},ve=n("hr",{class:"mb-8"},null,-1),ge={class:"ltr:-mr-6 rtl:-ml-6 ltr:ml-0 rtl:mr-0 col-span-full grid grid-cols-1 sm:grid-cols-2"},ye=["value"],ke=n("div",{class:"py-2"},null,-1),Ve={key:0,class:"form-error"},we=n("div",{class:"py-2"},null,-1),xe={key:0,class:"form-error"},Ce={class:"px-8 py-4 bg-gray-100 border-t border-gray-200 flex items-center"};function Se(e,s,l,p,t,_){var S,U,I,T,M,R,j,F,L,N;const B=c("Icons"),O=c("Link"),E=c("trashed-message"),w=c("text-input"),x=c("v-select"),J=c("select-input"),C=c("textarea-input"),z=c("checkbox-input"),A=c("radio-input"),q=c("DeleteRestoreComponent"),G=c("loading-button");return o(),m("div",null,[n("h1",oe,[d(O,{class:"text-gray-600 hover:text-gray-800 inline-flex items-center",href:e.route("measurements")},{default:v(()=>[d(B,{name:"back",class:"flex-shrink-0 w-3 h-3 md:w-5 md:h-5 fill-current ltr:mr-2 rtl:ml-2 rtl:rotate"}),g(" "+u(e.$tc("Measurement",2)),1)]),_:1},8,["href"]),me,g(" "+u(t.form.name),1)]),l.measurement.deleted_at?(o(),y(E,{key:0,class:"mb-6",onRestore:s[0]||(s[0]=()=>t.restore=!0)},{default:v(()=>[g(u(e.$t("already_deleted_x",{x:e.$tc("Measurement")})),1)]),_:1})):f("",!0),n("div",ae,[n("form",{onSubmit:s[6]||(s[6]=te((...r)=>_.submit&&_.submit(...r),["prevent"])),autocomplete:"off"},[n("div",ne,[d(w,{modelValue:t.form.name,"onUpdate:modelValue":s[1]||(s[1]=r=>t.form.name=r),errors:(S=e.$page.props.errors)==null?void 0:S.name,class:"ltr:pr-6 rtl:pl-6 pb-8 w-full",label:e.$t("Type Name")},null,8,["modelValue","errors","label"])]),n("div",ie,[n("div",ue,[n("label",pe,u(e.$tc("Customer")),1),d(x,{transition:"",modelValue:t.customer,"onUpdate:modelValue":s[2]||(s[2]=r=>t.customer=r),options:t.customers,"input-id":"customer_id",onSearch:_.searchCustomers,dir:e.$page.props.user.account.direction,placeholder:e.$t("search_x",{x:e.$tc("Customer",2)}),class:D({error:((U=e.$page.props.errors)==null?void 0:U.customer_id)&&((I=e.$page.props.errors)==null?void 0:I.customer_id.length)})},null,8,["modelValue","options","onSearch","dir","placeholder","class"]),(T=e.$page.props.errors)!=null&&T.customer_id?(o(),m("div",ce,u((M=e.$page.props.errors)==null?void 0:M.customer_id[0]),1)):f("",!0)]),n("div",de,[n("label",he,u(e.$tc("Service")),1),d(x,{transition:"",modelValue:t.service,"onUpdate:modelValue":s[3]||(s[3]=r=>t.service=r),options:t.services,"input-id":"service_id",onSearch:_.searchServices,dir:e.$page.props.user.account.direction,placeholder:e.$t("search_x",{x:e.$tc("Service",2)}),class:D({error:((R=e.$page.props.errors)==null?void 0:R.service_id)&&((j=e.$page.props.errors)==null?void 0:j.service_id.length)})},null,8,["modelValue","options","onSearch","dir","placeholder","class"]),(F=e.$page.props.errors)!=null&&F.service_id?(o(),m("div",fe,u((L=e.$page.props.errors)==null?void 0:L.service_id[0]),1)):f("",!0)]),t.service&&t.service.measurement_fields&&t.service.measurement_fields.length?(o(),m("div",_e,[n("h1",be,u(e.$tc("Measurement Field",2)),1),ve,n("div",ge,[(o(!0),m(b,null,k(t.service.measurement_fields,(r,i)=>(o(),m(b,null,[r.type=="Text"?(o(),m("div",{key:"in_"+i},[d(w,{label:r.name,modelValue:t.form[r.name],"onUpdate:modelValue":a=>t.form[r.name]=a,errors:e.$page.props.errors[r.name],class:"ltr:pr-6 rtl:pl-6 pb-8"},null,8,["label","modelValue","onUpdate:modelValue","errors"])])):r.type=="Select"?(o(),m("div",{key:"in_"+i},[d(J,{label:r.name,modelValue:t.form[r.name],"onUpdate:modelValue":a=>t.form[r.name]=a,errors:e.$page.props.errors[r.name],class:"ltr:pr-6 rtl:pl-6"},{default:v(()=>[(o(!0),m(b,null,k(r.options,(a,h)=>(o(),m("option",{key:"o_"+h,value:a.value},u(a.value),9,ye))),128))]),_:2},1032,["label","modelValue","onUpdate:modelValue","errors"])])):r.type=="Textarea"?(o(),m("div",{key:"in_"+i,class:"col-span-full"},[(o(),y(C,{label:r.name,key:"in_"+i,modelValue:t.form[r.name],"onUpdate:modelValue":a=>t.form[r.name]=a,errors:e.$page.props.errors[r.name],class:"ltr:pr-6 rtl:pl-6 pb-8 w-full"},null,8,["label","modelValue","onUpdate:modelValue","errors"]))])):r.type=="Checkbox"?(o(),m("div",{key:"in_"+i},[(o(),m("div",{class:"ltr:text-left rtl:text-right ltr:pr-6 rtl:pl-6 mb-8",key:"in_"+i},[(o(),m("label",{class:"form-label mr-6",key:"in_"+i},u(r.name),1)),ke,(o(!0),m(b,null,k(r.options,(a,h)=>(o(),y(z,{label:a.value,class:"mb-2 w-full",id:"cb_"+h+"_"+i,key:"cb_"+h+"_"+i,value:t.form[r.name][a.value],errors:e.$page.props.errors[r.name],checked:t.form[r.name][a.value]==!0,"onUpdate:checked":V=>_.updateFormValue(V,r.name,a.value)},null,8,["label","id","value","errors","checked","onUpdate:checked"]))),128)),e.$page.props.errors[r.name]&&e.$page.props.errors[r.name].length?(o(),m("div",Ve,u(e.$page.props.errors[r.name][0]),1)):f("",!0)]))])):r.type=="Radio"?(o(),m("div",{key:"in_"+i},[(o(),m("div",{class:"ltr:text-left rtl:text-right ltr:pr-6 rtl:pl-6 mb-8",key:"in_"+i},[(o(),m("label",{class:"form-label mr-6",key:"in_"+i},u(r.name),1)),we,(o(!0),m(b,null,k(r.options,(a,h)=>(o(),y(A,{name:r.name,label:a.value,value:a.value,class:"mb-2 w-full mr-6",id:"r_"+h+"_"+i,key:"r_"+h+"_"+i,checked:a.value==t.form[r.name],errors:e.$page.props.errors[r.name],onInput:V=>_.updateFormValue(V,r.name)},null,8,["name","label","value","id","checked","errors","onInput"]))),128)),e.$page.props.errors[r.name]&&e.$page.props.errors[r.name].length?(o(),m("div",xe,u(e.$page.props.errors[r.name][0]),1)):f("",!0)]))])):f("",!0)],64))),256))])])):f("",!0),d(C,{high:"",label:e.$t("Description"),modelValue:t.form.measurement,"onUpdate:modelValue":s[4]||(s[4]=r=>t.form.measurement=r),errors:(N=e.$page.props.errors)==null?void 0:N.measurement,class:"ltr:pr-6 rtl:pl-6 pb-8 w-full"},null,8,["label","modelValue","errors"])]),n("div",Ce,[d(q,{restore:t.restore,data:l.measurement,model:"Measurement",routeM:"measurements",onCloseRestore:s[5]||(s[5]=()=>t.restore=!1)},null,8,["restore","data"]),d(G,{loading:t.sending,class:"btn-gray ltr:ml-auto rtl:mr-auto",type:"submit"},{default:v(()=>[g(u(e.$t("update_x",{x:e.$tc("Measurement")})),1)]),_:1},8,["loading"])])],32)])])}const qe=se(le,[["render",Se]]);export{qe as default};
